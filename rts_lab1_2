--rts_lab1.adb
--Real Time System Lab1
with Ada.Text_IO; -- Use package Ada.Text_IO
use Ada.Text_IO; -- Integrate its namespace
with Ada.Calendar; -- Use package Ada.Calendar
use Ada.Calendar;
with Ada.Numerics.Float_Random;
use Ada.Numerics.Float_Random;

procedure rts_lab1_2 is
	--Message : constant String := "The time is"; 
	short_period : Duration := 0.5;
	long_period : Duration := 1.0;
	Start_Time : Time;
	Next_Time: Time;
	G : Generator;
    F3exeutedtime : Uniformly_Distributed;

	procedure F1 is
	begin
		Put("F1 executing, time is now: ");
		Put_Line(Duration'Image(Clock - Start_Time));
	end F1;

	procedure F2 is
	begin
		Put("F2 executing, time is now: ");
		Put_Line(Duration'Image(Clock - Start_Time));
	end F2;
	
	procedure F3 is
	begin
		Put("F3 executing, time is now: ");
		Put_Line(Duration'Image(Clock - Start_Time));
	end F3;

begin 
	Start_Time := Clock;
	Next_Time := Start_Time+short_period;
	loop
	    F1;
        F2;
        delay until Next_Time;
        reset(G);
        F3exeutedtime:=Random(G);

        if (F3exeutedtime>0.5) then
            Put_Line("F3 executed more than 0.5.");
            Next_Time := Next_Time + long_period;
		else
            Put_Line("F3 executed less than 0.5.");
            Next_Time := Next_Time + short_period;
        end if;
        F3;
        delay until Next_Time;
        Next_Time := Next_Time + short_period;
    end loop;

end rts_lab1_2;
